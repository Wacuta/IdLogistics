/*
 *
 * SpreadJS Library 3.20151.16
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 *
 **/
var wijmo;(function(n){(function(n){var y,o,c,l,r,s,u,a,v;n.feature("group",["core.common","core.stringResource"]);var t=null,e=undefined,i=Math.max,f=Math.min,h="undefined";(function(n){n[n.Expanded=0]="Expanded";n[n.Collapsed=1]="Collapsed"})(n.GroupState||(n.GroupState={}));y=n.GroupState;o=function(){function n(n,i,r,u){var f=this;f.model=t;f.children=t;f.parent=t;f.start=0;f.end=0;f.level=0;f.model=n;f.start=i;f.end=r;f.level=u}return n.prototype.getState=function(){return this.model?this.model.getState(this):0},n.prototype.setState=function(n){this.model&&this.model.expand(this.level,n===0)},n.prototype.contains=function(n){return this.start<=n&&n<=this.end},n.prototype.addChild=function(n){var t=this;n&&(t.children||(t.children=[]),t.children.push(n),n.parent=t)},n}();n.RangeGroupInfo=o;c=function(){function n(){this.count=0}return n.prototype.addRef=function(){this.count++},n.prototype.release=function(){this.count--},n.prototype.isWorking=function(){return this.count>0},n}();n.WorkingState=c;l=function(){function i(n){var i=this;i.head=t;i.tail=t;i.items=t;i._rootCached=t;i.direction=1;i.suspendAddingGroup=new c;i.items=new Array(n);i._empty=!0}return i.prototype.setDirection=function(n){this.direction=n},i.prototype.getDirection=function(){return this.direction},i.prototype._getCount=function(){var n=this.items;return n?n.length:0},i.prototype.group=function(i,u){var f=this,e,s,o;if(!f._isIndexValid(i))throw new Error(n.SR.Exp_InvalidIndex);if(!f._isIndexValid(i+u-1))throw new Error(n.SR.Exp_InvalidCount);for(f._rootCached=t,e=0;e<u;e++)s=i+e,o=f._getModelIndexFromViewIndex(s),f.items[o]?f.items[o].level++:f.items[o]=new r;f._rootCached=f.createRangeGroup();f._empty=!1},i.prototype.ungroupRange=function(i,r){var u=this,k,g,v,nt,y,p,w;if(!u._isIndexValid(i))throw new Error(n.SR.Exp_InvalidIndex);if(!u._isIndexValid(i+r-1))throw new Error(n.SR.Exp_InvalidCount);var h=!1,f=t,c=-1;if(u.direction===1){if(c=i+r,h=u._isIndexValid(c),h){var l=i+r-1,b=l,o=t;do k=u._getModelIndexFromViewIndex(l),o=u.items[k],o!==e&&o!==t&&(b=l),l--;while((o===e||o===t)&&l>=i);o!==e&&o!==t&&(f=u._findImp(u._rootCached,b,o.level),f&&(c=f.end+1),h=f&&(f.end===i+r-1||u.getState(f)===1))}}else if(u.direction===0&&(c=i-1,h=u._isIndexValid(c),h)){var a=i,d=a,s=t;do g=u._getModelIndexFromViewIndex(a),s=u.items[g],s!==e&&s!==t&&(d=a),a++;while((s===e||s===t)&&a<i+r);s!==e&&s!==t&&(f=u._findImp(u._rootCached,d,s.level),f&&(c=f.start-1),h=f&&(f.start===i||u.getState(f)===1))}for(u._rootCached=t,v=0;v<r;v++)nt=i+v,y=u._getModelIndexFromViewIndex(nt),u.items[y]&&u.items[y].level>-1&&u.items[y].level--;h&&(p=u._getModelIndexFromViewIndex(c),w=u.items[p],w&&w.level===f.level&&(u.items[p]=t));u._rootCached=u.createRangeGroup()},i.prototype.ungroup=function(){var n=this,i;n._rootCached=t;i=n._getCount();n.items=new Array(i);n._rootCached=n.createRangeGroup();n._empty=!0},i.prototype._expand=function(t,i,r){if(!this._isIndexValid(t))throw new Error(n.SR.Exp_InvalidIndex);if(i<-1)throw new Error(n.SR.Exp_InvalidLevel);var u=this.find(t,i);u&&this.expandGroup(u,r)},i.prototype.expand=function(t,i){if(t<-1)throw new Error(n.SR.Exp_InvalidLevel);for(var r=new s(this);r.moveNext();)this._expand(r.current,t,i)},i.prototype.expandGroup=function(t,i){if(!t)throw new Error(n.SR.Exp_GroupInfoIsNull);var r=-1;switch(this.direction){case 0:r=t.start-1;break;case 1:r=t.end+1;break}this.setCollapsed(r,!i)},i.prototype.isCollapsed=function(n){var i=this.getLevel(n),t;if(i>-1)for(t=this._findImp(this._rootCached,n,i);t;){if(t.getState()===1)return!0;t=t.parent}return!1},i.prototype.find=function(i,r){var u=this._rootCached;if(u){if(r===-1)return u;if(!this._isIndexValid(i))throw new Error(n.SR.Exp_InvalidIndex);return this._findImp(u,i,r)}return t},i.prototype.getLevel=function(t){if(!this._isIndexValid(t))throw new Error(n.SR.Exp_InvalidIndex);var r=this._getModelIndexFromViewIndex(t),i=this.items[r];return i?i.level:-1},i.prototype.getCollapsed=function(n){var i=this._getModelIndexFromViewIndex(n),t=this.items[i];return t?!!t.collapsed:!1},i.prototype.setCollapsed=function(n,i){var u=this,s=!1,f,o;if(n<0)f=u.head,f||(f=u.head=new r),f.collapsed!==i&&(f.collapsed=i,s=!0);else if(n>-1&&n<u._getCount()){var h=u._getModelIndexFromViewIndex(n),c=u.items,e=c[h];e||(e=c[h]=new r,e.level=-1);e.collapsed!==i&&(e.collapsed=i,s=!0)}else n>=u._getCount()&&(o=u.tail,o||(o=u.tail=new r),o.collapsed!==i&&(o.collapsed=i,s=!0));s&&(u._rootCached=t,u.refresh())},i.prototype.getMaxLevel=function(){for(var t=-1,u=this.items,f=u.length,i,n,r=0;r<f;r++)i=u[r],n=i&&i.level,typeof n!==h&&n>t&&(t=n);return t},i.prototype._move=function(i,u,f){var e=this,s,o,l,h,c;if(f>0){if(i<0&&(i=0),u<0&&(u=0),i===u)return;for(s=[],o=n.ArrayHelper.nextNonEmptyIndex(e.items,i-1);o>=0&&o<i+f;)l=new r(e.items[o]),s.push({index:o-i,value:l}),o=n.ArrayHelper.nextNonEmptyIndex(e.items,o);if(n.ArrayHelper.clear(e.items,i,f),n.ArrayHelper.clear(e.items,u,f),s.length>0)for(h=0;h<s.length;h++)c=s[h],e.items[u+c.index]=c.value;e._rootCached=t;e.refresh()}},i.prototype._copy=function(i,u,f){var e=this,s,o,l,h,c;if(f>0){if(i<0&&(i=0),u<0&&(u=0),i===u)return;for(s=[],o=n.ArrayHelper.nextNonEmptyIndex(e.items,i-1);o>=0&&o<i+f;)l=new r(e.items[o]),s.push({index:o-i,value:l}),o=n.ArrayHelper.nextNonEmptyIndex(e.items,o);if(n.ArrayHelper.clear(e.items,u,f),s.length>0)for(h=0;h<s.length;h++)c=s[h],e.items[u+c.index]=c.value;e._rootCached=t;e.refresh()}},i.prototype._add=function(n,i){var u=this,e,s,h,c,f,o;if(i>0){for(e=u._getModelIndexFromViewIndex(n),s=e>1?u.items[e-1]:t,h=0;h<i;h++)u.items.splice(e,0,!s?t:new r(s));if(!u.suspendAddingGroup.isWorking()&&n>0&&(c=u._getModelIndexFromViewIndex(n-1),f=t,f=c<0?u.head:u.items[c],f))for(o=0;o<i;o++)u.items[n+o]=new r({collapsed:f.collapsed,level:f.level});u._rootCached=t;u.refresh()}},i.prototype._remove=function(n,i){i>0&&(this.items.splice(n,i),this._rootCached=t,this.refresh())},i.prototype.equals=function(n){var t=this,i=n,r;if(i){if(!t.items&&i.items&&i.items.length>0||!i.items&&t.items&&t.items.length>0||!t.rangeGroupItemInfoEquals(t.head,i.head)||!t.rangeGroupItemInfoEquals(t.tail,i.tail))return!1;if(t.items&&i.items){if(t.direction!==i.direction||t.items.length!==i.items.length)return!1;for(r=0;r<t.items.length;r++)if(!t.items[r]&&i.items[r]||t.items[r]&&!i.items[r])return!1}return!0}return!1},i.prototype._isEmpty=function(){return this._empty},i.prototype.refresh=function(){this._isEmpty()||(this._rootCached=this.createRangeGroup())},i.prototype._setCount=function(n){var i=this,u,f,e;if(i.items||(i.items=new Array(n)),i._rootCached=t,u=i._getCount(),n<u)i.items.splice(n,u-n);else if(n>u)if(f=i.items[i.items.length-1],f)for(e=0;e<n-u;e++)i.items.push(new r(f));else i.items=i.items.concat(new Array(n-u));i.refresh()},i.prototype.getState=function(n){var r=this,i=-1,u,f,e;switch(r.direction){case 1:i=n.end+1;break;case 0:i=n.start-1;break}return u=t,f=r._getCount(),i<0&&(u=r.head),i>-1&&i<f?(e=r._getViewIndexFromModelIndex(i),u=r.items[e]):i>=f&&(u=r.tail),u&&u.collapsed?1:0},i.prototype._setLevel=function(n,i){var u=this,f;n<0?(u.head||(u.head=new r),u.head.level=i):n>-1&&n<u._getCount()?(f=u._getModelIndexFromViewIndex(n),u.items[f]||(u.items[f]=new r,u.items[f].level=-1),u.items[f].level=i):n>=u._getCount()&&(u.tail||(u.tail=new r),u.tail.level=i);u._rootCached=t;u.refresh()},i.prototype.suspendAdding=function(){this.suspendAddingGroup.addRef()},i.prototype.resumeAdding=function(){this.suspendAddingGroup.release()},i.prototype._getViewIndexFromModelIndex=function(n){return n},i.prototype._getModelIndexFromViewIndex=function(n){return n},i.prototype.rangeGroupItemInfoEquals=function(n,t){return n?t?n.level===t.level&&n.collapsed===t.collapsed:!1:!t},i.prototype.createRangeGroup=function(){for(var n=this,i=new o(n,0,n._getCount()-1,-1),r=new s(n),t;r.moveNext();)t=n._createRangeGroup(r,0),t&&t.level>-1&&i.addChild(t);return i},i.prototype._createRangeGroup=function(n,i){var f=this,u=t,h;do{var r=n.current,c=f._getModelIndexFromViewIndex(r),e=f.items[c],s=n.nextToCurrent();if(e.level<i)continue;else e.level>=i&&(u||(u=new o(f,r,r,i)));if(e.level>i&&(h=f._createRangeGroup(n,i+1),n.current>-1?(r=n.current,s=n.nextToCurrent()):(r=h.end,s=-1),u.addChild(h)),r>u.end&&(u.end=r),f.isGroupEnd(r,s,i))return u}while(n.moveNext());return u},i.prototype.isGroupEnd=function(n,t,i){var r=this,h=r._getModelIndexFromViewIndex(n),e=r.items[h],s,u,o,f;if(!r._isIndexValid(t)||(s=r._getModelIndexFromViewIndex(t),u=r.items[s],!u))return!0;if(u.level<e.level){if(o=e.level-u.level,f=e.level-i,o===f)return!1;if(f>=0&&f<o)return!0}return!1},i.prototype._isIndexValid=function(n){return n>=-1&&n<this._getCount()},i.prototype._findImp=function(n,i,r){var u,f,o,e;if(n)for(u=[],u.unshift(n);u.length>0;){if(n=u.pop(),n.level===r&&n.contains(i))return n;if(f=n.children,o=f&&f.length,o>0)for(e=0;e<o;e++)u.unshift(f[e])}return t},i.prototype.fromJSON=function(n,i){var u,h,c,s,f,o;if(n){if(u=this,h=u.items,n.itemsData)for(c=n.itemsData.length,s=0;s<c;s++)if(f=n.itemsData[s],f.count>0&&f.index>=0&&f.info){for(o=0;o<f.count;o++){if(f.index+o>=h.length)break;h[f.index+o]=new r(f.info)}u._empty=!1}n.direction!==t&&n.direction!==e&&(u.direction=n.direction);n.head&&(u.head=n.head);n.tail&&(u.tail=n.tail);u._rootCached=t;u.refresh()}},i.prototype.toJSON=function(){for(var s,f,o,h,r=this,i=[],n=-1,u=r.items,t=0;t<u.length;t++)u[t]&&(n>=0&&t===i[n].count+i[n].index&&u[t].level===i[n].info.level&&u[t].collapsed===i[n].info.collapsed?i[n].count++:(n++,i[n]={index:t,count:1,info:u[t]}));s={itemsData:i,direction:r.direction,head:r.head,tail:r.tail};f={};for(o in s)h=s[o],r._isDefaultValue(o,h)||(f[o]=h);return $.isEmptyObject(f)?e:f},i.prototype._isDefaultValue=function(n,i){switch(n){case"head":return i===t;case"tail":return i===t;case"direction":return i===1;case"itemsData":return i.length===0;default:return!1}},i}();n.RangeGroup=l;r=function(){function n(n){var t=this;t!==n&&n&&(t.level=n.level,t.collapsed=n.collapsed);n||(t.level=0,t.collapsed=!1)}return n}();n.RangeGroupItemInfo=r;s=function(){function n(n){this.isEOF=!1;this.rangeGroup=t;this.current=-1;this.rangeGroup=n}return n.prototype.nextToCurrent=function(){return this.current+1},n.prototype.moveNext=function(){var n=this,i,t,r;if(n.isEOF||!n.rangeGroup||!n.rangeGroup.items)return!1;for(i=!1,t=n.current+1;t<n.rangeGroup.items.length;t++)if(r=n.rangeGroup._getModelIndexFromViewIndex(t),n.rangeGroup.items[r]){i=!0;n.current=t;break}return i||(n.current=-1),n.current>-1?!0:(n.isEOF=!0,!1)},n.prototype.reset=function(){this.isEOF=!1;this.current=-1},n}();n.GroupedItemIndexEnumerator=s;u={getThemeBackgroundColor:function(t,i){if(t.parent&&t.parent.useWijmoTheme){var r=n.Global.prototype.getWijmoThemeStyle(0);r&&r.backgroundColor&&r.backgroundColor!==""&&(i=r.backgroundColor)}return i},getThemeForeColor:function(t,i){if(t.parent&&t.parent.useWijmoTheme){var r=n.Global.prototype.getWijmoThemeStyle(0);r&&r.color&&r.color!==""&&(i=r.color)}return i}};a=function(){function r(n,i,r,u){var f=this;f.PADDING=2;f.LINE_SIZE=2;f.STARTLINE_SIZE=6;f._groupLineInfos=t;f._groupDotInfos=t;f._groupButtonInfos=t;f._sheet=n;f._rowGroup=i;f._viewportIndex=r;f._maxLevel=typeof u===h?i?n.rowRangeGroup.getMaxLevel():n.colRangeGroup.getMaxLevel():u}return r.prototype.createGroupInfo=function(){var n=this,i,r,t;if(n._groupLineInfos=[],n._groupDotInfos=[],n._groupButtonInfos=[],i=n._rowGroup,r=n._maxLevel,r!==-1){var u=n._sheet._getGroupLayout(),s=n._calcMinWidthOrHeight({width:u.width,height:u.height},i),f=n.getGroupsByLevel(0,i),e=f.length,o;if(e>0)for(t=0;t<e;t++)o=f[t],n._measureGroups(o,s)}},r.prototype.paintGroups=function(n){this._rowGroup?this._paintRowGroups(n):this._paintColumnGroups(n)},r.prototype._calcMinWidthOrHeight=function(n,t){var r=0,u=this._maxLevel;return r=t?(n.width-this.PADDING*2)/(u+2):(n.height-this.PADDING*2)/(u+2),i(0,r)},r.prototype._measureGroups=function(r,u){var c=this,st=c._rowGroup,s=c.getGroupDirection(st),y=c.getViewportStartIndex(st),p=c.getViewportEndIndex(st),a=r.start,v=r.end,o,e,h,k,d,g,nt,ht,l,w,b,it,ct,rt,ut,ft,et,ot,vt,yt;if(r.getState()===0){if(k=!0,d=r.parent,d&&(s===0&&a===d.start||s===1&&v===d.end)&&(k=!1),k&&(o={isExpanded:!0,level:r.level,paintLine:!0},s===1?(e=v+1,e>=y&&e<=p&&(o.index=e,o.lineDirection=1,c._groupButtonInfos.push(o))):s===0&&(e=a-1,e>=y&&e<=p&&(o.index=e,o.lineDirection=0,c._groupButtonInfos.push(o)))),a<=p&&v>=y){for(g=i(y,a),nt=f(p,v),k&&(ht={start:g,end:nt,level:r.level,startLine:t},(s===1&&g===a||s===0&&nt===v)&&(ht.startLine=!0),c._groupLineInfos.push(ht)),l=[],h=g;h<=nt;h++)l.push(h);if(w=r.children,b=w&&w.length,b>0)for(h=0;h<b;h++){var tt=w[h],lt=tt.start,at=tt.end;if(tt.getState()===1)for(it=lt;it<=at;it++)n.ArrayHelper.remove(l,it);s===1?n.ArrayHelper.remove(l,at+1):s===0&&n.ArrayHelper.remove(l,lt-1);c._measureGroups(tt,u)}if(ct=!0,b>0)for(rt=0;rt<b;rt++)if(ut=w[rt],ut)if(ft=ut.start,et=ut.end,ft===a&&et===v){ct=!1;break}else if(s===1&&et===v||s===0&&ft===a)for(ot=ft;ot<=et;ot++)n.ArrayHelper.remove(l,ot);if(ct&&l.length>0)for(h=0;h<l.length;h++)vt=l[h],yt={index:vt,level:r.level+1},c._groupDotInfos.push(yt)}}else r.getState()===1&&(o={isExpanded:!1,level:r.level},s===1?(e=v+1,e>=y&&e<=p&&(o.index=e,o.lineDirection=1,c._groupButtonInfos.push(o))):s===0&&(e=a-1,e>=y&&e<=p&&(o.index=e,o.lineDirection=0,c._groupButtonInfos.push(o))))},r.prototype._paintRowGroups=function(n){var l=this,ii=l._maxLevel,et,pt,wt,dt,st,gt,ht,it,ct,w,k,rt,b,ni,ti,lt;if(ii!==-1){var p=l._sheet,e=p._getGroupLayout(),a=l._calcMinWidthOrHeight({width:e.width,height:e.height},!0);if(a!==0){n.save();var at=l.STARTLINE_SIZE,vt=l.PADDING,y=l.LINE_SIZE,ut=i(0,(a-at)/2)+vt,h,r,s,o,d=p._getRowLayout(l._viewportIndex,3),ft=l._groupDotInfos,yt=ft&&ft.length;if(yt>0)for(s=0;s<yt;s++)et=ft[s],o=d.findRow(et.index),o&&o.height>=y&&(h=et.level*a+ut,r=o.y+i(0,(o.height-y)/2),pt=y,wt=y,n.fillStyle=u.getThemeForeColor(p,"black"),n.fillRect(e.x+h+.5,e.y+r,pt,wt));var bt=p.rowRangeGroup.direction,ot=l._groupLineInfos,kt=ot&&ot.length;if(kt>0)for(s=0;s<kt;s++){var g=ot[s],nt=g.start,tt=g.end,v=t,c=t;do v=d.findRow(nt),nt++;while(!v&&nt<=tt);do c=d.findRow(tt),tt--;while(!c&&tt>=nt);if(v||c)!v&&c?v=c:v&&!c&&(c=v);else continue;h=g.level*a+ut;r=v.y;bt===1&&(r+=1);dt=y;st=i(0,c.y+c.height-v.y);n.fillStyle=u.getThemeForeColor(p,"black");n.fillRect(e.x+h+.5,e.y+r,dt,st);gt=g.startLine;gt&&(ht=f(at,a-y),ht>0&&(bt===0&&(r=r+st-y),r>=v.y&&r<c.y+c.height&&(n.fillStyle=u.getThemeForeColor(p,"black"),n.fillRect(e.x+h+.5,e.y+r,ht,y))))}if(it=l._groupButtonInfos,ct=it&&it.length,ct>0)for(s=0;s<ct;s++)(w=it[s],o=d.findRow(w.index),!o||o&&o.height<=0)||(k=i(0,(o.height-a)/2),h=w.level*a+vt,r=o.y+k,rt=a,b=f(a,o.height),n.strokeStyle="gray",n.lineWidth=1,n.strokeRect(e.x+h+.5,e.y+r,rt,b),w.isExpanded||n.fillRect(e.x+h+rt/2-1+.5,e.y+r+4,2,b-8),n.fillRect(e.x+h+4+.5,e.y+r+b/2-1,rt-8,2),ni=w.paintLine,ni&&b<o.height&&(h=w.level*a+ut,r=o.y,ti=y,lt=k,w.lineDirection===0&&(r+=k+b,lt=o.height-b-k),n.fillStyle=u.getThemeForeColor(p,"black"),n.fillRect(e.x+h+.5,e.y+r,ti,lt)));n.stroke();n.beginPath();n.restore()}}},r.prototype._paintColumnGroups=function(n){var l=this,ti=l._maxLevel,ut,at,ft,vt,yt,et,bt,kt,ot,st,dt,w,k,b,it,gt,ht,ni;if(ti!==-1){var p=l._sheet,e=p._getGroupLayout(),a=l._calcMinWidthOrHeight({width:e.width,height:e.height},!1);if(a!==0){var ct=l.STARTLINE_SIZE,lt=l.PADDING,y=l.LINE_SIZE,rt=i(0,(a-ct)/2)+lt,r,h,s,o,d=p._getColumnLayout(l._viewportIndex,3);for(n.save(),ut=l._groupDotInfos,at=ut.length,s=0;s<at;s++)ft=ut[s],o=d.findCol(ft.index),o&&o.width>=y&&(r=o.x+i(0,(o.width-y)/2),h=ft.level*a+rt,vt=y,yt=y,n.fillStyle=u.getThemeForeColor(p,"black"),n.fillRect(e.x+r,e.y+h+.5,vt,yt));var pt=p.colRangeGroup.direction,wt=l._groupLineInfos,ii=wt.length;for(s=0;s<ii;s++){var g=wt[s],nt=g.start,tt=g.end,v=t,c=t;do v=d.findCol(nt),nt++;while(!v&&nt<=tt);do c=d.findCol(tt),tt--;while(!c&&tt>=nt);if(v||c)!v&&c?v=c:v&&!c&&(c=v);else continue;r=v.x;pt===1&&(r+=1);h=g.level*a+rt;et=i(0,c.x+c.width-v.x);bt=y;n.fillStyle=u.getThemeForeColor(p,"black");n.fillRect(e.x+r,e.y+h+.5,et,bt);kt=g.startLine;kt&&(ot=f(ct,a-y),ot>0&&(pt===0&&(r=r+et-y),r>=v.x&&r<c.x+c.width&&(n.fillStyle=u.getThemeForeColor(p,"black"),n.fillRect(e.x+r,e.y+h+.5,y,ot))))}for(st=l._groupButtonInfos,dt=st.length,s=0;s<dt;s++)(w=st[s],o=d.findCol(w.index),!o||o&&o.width<=0)||(k=i(0,(o.width-a)/2),r=o.x+k,h=w.level*a+lt,b=f(a,o.width),it=a,n.strokeStyle="gray",n.lineWidth=1,n.strokeRect(e.x+r,e.y+h+.5,b,it),w.isExpanded||n.fillRect(e.x+r+b/2-1,e.y+h+4.5,2,it-8),n.fillRect(e.x+r+4,e.y+h+it/2-.5,b-8,2),gt=w.paintLine,gt&&b<o.width&&(r=o.x,h=w.level*a+rt,ht=k,ni=y,w.lineDirection===0&&(r+=k+b,ht=o.width-b-k),n.fillStyle=u.getThemeForeColor(p,"black"),n.fillRect(e.x+r,e.y+h+.5,ht,ni)));n.beginPath();n.restore()}}},r.prototype.getRowOrColumnStartIndex=function(n){var u=this._sheet,e=this._viewportIndex,t,o,r,s;if(n){if(t=u._getRowLayout(e),t&&t.length>0)return o=t[0].row,i(0,o-1)}else if(r=u._getColumnLayout(e),r&&r.length>0)return s=r[0].col,f(0,s-1);return-1},r.prototype.getRowOrColumnCount=function(n){var r=this._sheet,u=this._viewportIndex,t,e,i,o;if(n){if(t=r._getRowLayout(u),t&&t.length>0)return e=t[t.length-1].row,f(r.getRowCount(),e+2)}else if(i=r._getColumnLayout(u),i&&i.length>0)return o=i[i.length-1].col,f(r.getColumnCount(),o+2);return-1},r.prototype.getGroupsByLevel=function(n,t){for(var i=this,f=[],r=i.getRowOrColumnStartIndex(t),e=i.getRowOrColumnCount(t),o=t?i._sheet.rowRangeGroup:i._sheet.colRangeGroup,u;r<e;)u=o.find(r,n),u?(r=u.end+1,f.push(u)):r++;return f},r.prototype.getGroupDirection=function(n){return n?this._sheet.rowRangeGroup.direction:this._sheet.colRangeGroup.direction},r.prototype.getViewportStartIndex=function(n){var r=this._sheet,u=this._viewportIndex,t,i;if(n){if(t=r._getRowLayout(u),t&&t.length>0)return t[0].row}else if(i=r._getColumnLayout(u),i&&i.length>0)return i[0].col;return-1},r.prototype.getViewportEndIndex=function(n){var r=this._sheet,u=this._viewportIndex,t,i;if(n){if(t=r._getRowLayout(u),t&&t.length>0)return t[t.length-1].row}else if(i=r._getColumnLayout(u),i&&i.length>0)return i[i.length-1].col;return-1},r.prototype._processTouch=function(n){n&&this._sheet._isTouchMode&&(n.x-=2,n.y-=2,n.width+=4,n.height+=4)},r.prototype.getRowGroupButton=function(r,u){var e=this,g=e._maxLevel,c,l,o,b;if(g===-1)return t;var v=e._sheet,s=v._getGroupLayout(),h=e._calcMinWidthOrHeight({width:s.width,height:s.height},!0);if(h===0)return t;var y,p,nt=v._getRowLayout(e._viewportIndex,3),a=e._groupButtonInfos,w=a&&a.length;if(w>0)for(c=0;c<w;c++)if(l=a[c],o=nt.findRow(l.index),o&&(!o||!(o.height<=0))){b=i(0,(o.height-h)/2);y=l.level*h+e.PADDING;p=o.y+b;var k=h,tt=f(k,o.height),d=new n.Rect(s.x+y+.5,s.y+p+.5,k,tt);if(e._processTouch(d),d.contains(r,u))return l}return t},r.prototype.getColGroupButton=function(r,u){var e=this,g=e._maxLevel,c,l,o,b;if(g===-1)return t;var v=e._sheet,s=v._getGroupLayout(),h=e._calcMinWidthOrHeight({width:s.width,height:s.height},!1);if(h===0)return t;var y,p,nt=v._getColumnLayout(e._viewportIndex,3),a=e._groupButtonInfos,w=a&&a.length;if(w>0)for(c=0;c<w;c++)if(l=a[c],o=nt.findCol(l.index),o&&(!o||!(o.width<=0))){b=i(0,(o.width-h)/2);y=o.x+b;p=l.level*h+e.PADDING;var k=h,tt=f(k,o.width),d=new n.Rect(s.x+y+.5,s.y+p+.5,tt,k);if(e._processTouch(d),d.contains(r,u))return l}return t},r}();n._RangeGroupPresenter=a;v=function(){function r(n,i,r){var u=this;u._sheet=t;u._rowGroup=t;u._maxLevel=-1;u.PADDING=2;u._sheet=n;u._rowGroup=i;u._maxLevel=typeof r===h?i?n.rowRangeGroup.getMaxLevel():n.colRangeGroup.getMaxLevel():r}return r.prototype.paintGroupHeader=function(n){var h=this,o=h._sheet,k=h._maxLevel,b,y,p,s,f,c,l,a,v,w,r;if(o&&!(k<0)){var d=h._rowGroup,t=o._getGroupLayout(),e=h._calcMinWidthOrHeight({width:t.width,height:t.height},d);if(e!==0)if(b=k+2,r=o._getSheetLayout(),n.fillStyle=u.getThemeBackgroundColor(o,"#D7E6F7"),n.strokeStyle="gray",n.font="8.25pt Arial",n.lineWidth=1,d){if(n.fillRect(t.x,t.y,t.width,r.height),n.strokeRect(t.x-.5,t.y-.5,t.width,r.height+1),n.strokeRect(t.x-.5,r.headerY-.5,t.width,r.colHeaderHeight),n.fillStyle=u.getThemeForeColor(o,"black"),o.colHeaderVisible&&r.colHeaderHeight>=e)for(y=h.PADDING,p=i(0,r.headerY+(r.colHeaderHeight-e)/2),s=0;s<b;s++)f=e-1,c=t.x+y+.5,l=t.y+p,n.strokeRect(c,l,f,f),a=""+(s+1),v=n.measureText(a).width,w=o._getFontHeight(n.font),f>=v&&e>=w&&(n.textBaseline="middle",n.fillText(a,c+(f-v)/2,l+f/2)),y+=e}else if(n.fillRect(t.x,t.y,r.width,t.height),n.strokeRect(t.x-.5,t.y-.5,r.width+1,t.height),n.strokeRect(r.headerX-.5,t.y-.5,r.rowHeaderWidth,t.height),n.fillStyle=u.getThemeForeColor(o,"black"),o.rowHeaderVisible&&r.rowHeaderWidth>=e)for(y=i(0,r.headerX+(r.rowHeaderWidth-e)/2),p=h.PADDING,s=0;s<b;s++)f=e-1,c=t.x+y,l=t.y+p+.5,n.strokeRect(c,l,f,f),a=""+(s+1),v=n.measureText(a).width,w=o._getFontHeight(n.font),f>=v&&e>=w&&(n.textBaseline="middle",n.fillText(a,c+(f-v)/2,l+f/2)),p+=e}},r.prototype.getGroupButton=function(r,u){var s=this,c=s._sheet,p=s._maxLevel,y,l,a,e,v,o;if(!c||p<0)return t;var w=s._rowGroup,h=c._getGroupLayout(),f=s._calcMinWidthOrHeight({width:h.width,height:h.height},w);if(f===0)return t;if(y=p+2,o=c._getSheetLayout(),w){if(c.colHeaderVisible&&o.colHeaderHeight>=f)for(l=s.PADDING,a=i(0,o.headerY+(o.colHeaderHeight-f)/2),e=0;e<y;e++){if(v=new n.Rect(h.x+l,h.y+a,f,f),v.contains(r,u))return{index:e};l+=f}}else if(c.rowHeaderVisible&&o.rowHeaderWidth>=f)for(l=i(0,o.headerX+(o.rowHeaderWidth-f)/2),a=s.PADDING,e=0;e<y;e++){if(v=new n.Rect(h.x+l,h.y+a,f,f),v.contains(r,u))return{index:e};a+=f}return t},r.prototype._calcMinWidthOrHeight=function(n,t){var r=0,u=this._maxLevel;return r=t?(n.width-this.PADDING*2)/(u+2):(n.height-this.PADDING*2)/(u+2),i(0,r)},r}();n._RangeGroupHeaderPresenter=v})(n.spread||(n.spread={}));var t=n.spread})(wijmo||(wijmo={}))
